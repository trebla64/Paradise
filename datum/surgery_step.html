<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <base href="../" />
    <link rel="stylesheet" href="dmdoc.css" />
    <title>&#x2F;datum&#x2F;surgery_step - Paradise Station 13</title>
</head>
<body>
<header>
    <a href="index.html">Paradise Station 13</a> -
    <a href="index.html#modules">Modules</a> -
    <a href="index.html#types">Types</a>
 &mdash; <a href="datum/surgery_step.html#var">Var Details</a> - <a href="datum/surgery_step.html#proc">Proc Details</a></header>
<main>
<h1>surgery_step <aside>/<a href="datum.html">datum</a>/<a href="datum/surgery_step.html">surgery_step</a></aside>
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L173">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 173"/></a></h1>

<table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr>
            <tr><th><a href="datum/surgery_step.html#var/accept_any_item">accept_any_item</a></th><td>Does the surgery step accept any item? If true, ignores implements. Compatible with accept_hand.</td></tr>
            <tr><th><a href="datum/surgery_step.html#var/accept_hand">accept_hand</a></th><td>does the surgery step require an open hand? If true, ignores implements. Compatible with accept_any_item.</td></tr>
            <tr><th><a href="datum/surgery_step.html#var/allowed_tools">allowed_tools</a></th><td>Type path of tools that can be used to complete this step. Format is <code>path = probability of success</code>.
If the tool has a specific surgery tooltype, you can use that as a key as well.</td></tr>
            <tr><th><a href="datum/surgery_step.html#var/blood_level">blood_level</a></th><td>How much blood this step can get on surgeon. See SURGERY_BLOODSPREAD_* defines</td></tr>
            <tr><th><a href="datum/surgery_step.html#var/can_infect">can_infect</a></th><td>Whether this surgery step can cause an infection.</td></tr>
            <tr><th><a href="datum/surgery_step.html#var/chems_needed">chems_needed</a></th><td>List of chems needed in the mob to complete the step. Even on success, this step will have no effect if the required chems aren't in the mob.</td></tr>
            <tr><th><a href="datum/surgery_step.html#var/implement_type">implement_type</a></th><td>The current type of implement from allowed_tools in use. This has to be stored, as the typepath of the tool might not match the list type (such as if we're using tool behavior)</td></tr>
            <tr><th><a href="datum/surgery_step.html#var/repeatable">repeatable</a></th><td>Is this step repeatable by using the same tool again after it's finished?
Make sure it isn't the last step, or it's used in a cancellable surgery. Otherwise, you might get stuck in a loop!</td></tr>
            <tr><th><a href="datum/surgery_step.html#var/require_all_chems">require_all_chems</a></th><td>Do we require any of the needed chems, or all of them?</td></tr>
            <tr><th><a href="datum/surgery_step.html#var/silicons_obey_prob">silicons_obey_prob</a></th><td>Whether silicons ignore any probabilities (and are therefore &quot;perfect&quot; surgeons)</td></tr>
            <tr><th><a href="datum/surgery_step.html#var/time">time</a></th><td>duration of the step</td></tr>
            <tr><th><a href="datum/surgery_step.html#var/times_repeated">times_repeated</a></th><td>How many times this step has been automatically repeated.</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr>
            <tr><th><a href="datum/surgery_step.html#proc/can_repeat">can_repeat</a></th><td>Determines whether or not this surgery step can repeat if its end/fail steps returned SURGERY_STEP_RETRY.</td></tr>
            <tr><th><a href="datum/surgery_step.html#proc/chem_check">chem_check</a></th><td>Check that the target contains the chems we expect them to.</td></tr>
            <tr><th><a href="datum/surgery_step.html#proc/deal_pain">deal_pain</a></th><td>Try to inflict pain during a surgery, a surgeon's dream come true.
This will wake up the user if they're voluntarily sleeping.</td></tr>
            <tr><th><a href="datum/surgery_step.html#proc/end_step">end_step</a></th><td>Finish a surgery step, performing anything that runs on the tail-end of a successful surgery.
This runs if the surgery step passes the probability check, and therefore is a success.</td></tr>
            <tr><th><a href="datum/surgery_step.html#proc/fail_step">fail_step</a></th><td>Play out the failure state of a surgery step.
This runs if the surgery step fails the probability check, the right chems weren't present, or if the user deliberately failed the surgery.</td></tr>
            <tr><th><a href="datum/surgery_step.html#proc/get_step_information">get_step_information</a></th><td>Get the action that will be performed during this surgery step, in context of the surgery it is a part of.</td></tr>
            <tr><th><a href="datum/surgery_step.html#proc/initiate">initiate</a></th><td>Initiate and really perform the surgery itself.
This includes the main do-after and the checking of probabilities for successful surgeries.
If try_to_fail is TRUE, then this surgery will be deliberately failed out of.</td></tr>
            <tr><th><a href="datum/surgery_step.html#proc/is_valid_tool">is_valid_tool</a></th><td>Whether or not the tool being used is usable for the surgery.
Checks both the tool itself as well as any tool behaviors defined in allowed_tools.
Arguments:</td></tr>
            <tr><th><a href="datum/surgery_step.html#proc/slowdown_immune">slowdown_immune</a></th><td>Check for mobs that would be immune to surgery slowdowns/speedups.</td></tr>
            <tr><th><a href="datum/surgery_step.html#proc/tool_check">tool_check</a></th><td>Get whether the tool should be usable in its current state. Useful for checks to see if a welder is on, for example.</td></tr>
            <tr><th><a href="datum/surgery_step.html#proc/try_op">try_op</a></th><td>Try to perform an operation on a user.
Arguments:</td></tr></table>
    <h2 id="var">Var Details</h2><h3 id="var/accept_any_item"><aside class="declaration">var </aside>accept_any_item
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L183">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 183"/></a></h3>
        <p>Does the surgery step accept any item? If true, ignores implements. Compatible with accept_hand.</p><h3 id="var/accept_hand"><aside class="declaration">var </aside>accept_hand
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L181">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 181"/></a></h3>
        <p>does the surgery step require an open hand? If true, ignores implements. Compatible with accept_any_item.</p><h3 id="var/allowed_tools"><aside class="declaration">var </aside>allowed_tools
            <aside>&ndash; /list</aside>
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L177">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 177"/></a></h3>
        <p>Type path of tools that can be used to complete this step. Format is <code>path = probability of success</code>.
If the tool has a specific surgery tooltype, you can use that as a key as well.</p><h3 id="var/blood_level"><aside class="declaration">var </aside>blood_level
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L203">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 203"/></a></h3>
        <p>How much blood this step can get on surgeon. See SURGERY_BLOODSPREAD_* defines</p><h3 id="var/can_infect"><aside class="declaration">var </aside>can_infect
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L201">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 201"/></a></h3>
        <p>Whether this surgery step can cause an infection.</p><h3 id="var/chems_needed"><aside class="declaration">var </aside>chems_needed
            <aside>&ndash; /list</aside>
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L190">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 190"/></a></h3>
        <p>List of chems needed in the mob to complete the step. Even on success, this step will have no effect if the required chems aren't in the mob.</p><h3 id="var/implement_type"><aside class="declaration">var </aside>implement_type
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L179">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 179"/></a></h3>
        <p>The current type of implement from allowed_tools in use. This has to be stored, as the typepath of the tool might not match the list type (such as if we're using tool behavior)</p><h3 id="var/repeatable"><aside class="declaration">var </aside>repeatable
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L188">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 188"/></a></h3>
        <p>Is this step repeatable by using the same tool again after it's finished?
Make sure it isn't the last step, or it's used in a cancellable surgery. Otherwise, you might get stuck in a loop!</p><h3 id="var/require_all_chems"><aside class="declaration">var </aside>require_all_chems
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L192">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 192"/></a></h3>
        <p>Do we require any of the needed chems, or all of them?</p><h3 id="var/silicons_obey_prob"><aside class="declaration">var </aside>silicons_obey_prob
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L194">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 194"/></a></h3>
        <p>Whether silicons ignore any probabilities (and are therefore &quot;perfect&quot; surgeons)</p><h3 id="var/time"><aside class="declaration">var </aside>time
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L185">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 185"/></a></h3>
        <p>duration of the step</p><h3 id="var/times_repeated"><aside class="declaration">var </aside>times_repeated
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L196">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 196"/></a></h3>
        <p>How many times this step has been automatically repeated.</p><h2 id="proc">Proc Details</h2><h3 id="proc/can_repeat"><aside class="declaration">proc </aside>can_repeat<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/user, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/target, target_zone, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool, /<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/surgery) 
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L297">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 297"/></a></aside>
        </h3>
        <p>Determines whether or not this surgery step can repeat if its end/fail steps returned SURGERY_STEP_RETRY.</p>
<p>Arguments:</p>
<ul>
<li>user - mob performing the surgery</li>
<li>target - mob the surgery is being performed on</li>
<li>target_zone - body zone of the surgery</li>
<li>tool - tool used for the surgery</li>
<li>surgery - the operation this surgery step is a part of</li>
</ul>
<p>If this returns TRUE, the step will automatically retry. If not, the user will have to manually start the step again.</p><h3 id="proc/chem_check"><aside class="declaration">proc </aside>chem_check<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/target) 
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L534">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 534"/></a></aside>
        </h3>
        <p>Check that the target contains the chems we expect them to.</p><h3 id="proc/deal_pain"><aside class="declaration">proc </aside>deal_pain<aside>(/<a href="mob.html">mob</a>/user, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/target, target_zone, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool, /<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/surgery, try_to_fail) 
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L398">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 398"/></a></aside>
        </h3>
        <p>Try to inflict pain during a surgery, a surgeon's dream come true.
This will wake up the user if they're voluntarily sleeping.</p>
<p>Returns the success rate that the user's amount of pain would deal, while also handling extra pain behavior.</p><h3 id="proc/end_step"><aside class="declaration">proc </aside>end_step<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/user, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/<a href="mob/living/carbon/human.html">human</a>/target, target_zone, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool, /<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/surgery) 
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L460">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 460"/></a></aside>
        </h3>
        <p>Finish a surgery step, performing anything that runs on the tail-end of a successful surgery.
This runs if the surgery step passes the probability check, and therefore is a success.</p>
<p>Should return SURGERY_STEP_CONTINUE to advance the surgery, though may return SURGERY_STEP_INCOMPLETE to keep the surgery step from advancing.</p><h3 id="proc/fail_step"><aside class="declaration">proc </aside>fail_step<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/user, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/<a href="mob/living/carbon/human.html">human</a>/target, target_zone, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool, /<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/surgery) 
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L469">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 469"/></a></aside>
        </h3>
        <p>Play out the failure state of a surgery step.
This runs if the surgery step fails the probability check, the right chems weren't present, or if the user deliberately failed the surgery.</p>
<p>Should return SURGERY_STEP_INCOMPLETE to prevent the surgery step from advancing, though may return SURGERY_STEP_CONTINUE to advance to the next step regardless.</p><h3 id="proc/get_step_information"><aside class="declaration">proc </aside>get_step_information<aside>(/<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/surgery) 
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L477">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 477"/></a></aside>
        </h3>
        <p>Get the action that will be performed during this surgery step, in context of the surgery it is a part of.</p>
<ul>
<li>surgery - A surgery in progress.</li>
</ul><h3 id="proc/initiate"><aside class="declaration">proc </aside>initiate<aside>(/<a href="mob.html">mob</a>/user, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/target, target_zone, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool, /<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/surgery, try_to_fail) 
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L311">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 311"/></a></aside>
        </h3>
        <p>Initiate and really perform the surgery itself.
This includes the main do-after and the checking of probabilities for successful surgeries.
If try_to_fail is TRUE, then this surgery will be deliberately failed out of.</p>
<p>Returns TRUE if the surgery should proceed to the next step, or FALSE otherwise.</p><h3 id="proc/is_valid_tool"><aside class="declaration">proc </aside>is_valid_tool<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/user, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool) 
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L213">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 213"/></a></aside>
        </h3>
        <p>Whether or not the tool being used is usable for the surgery.
Checks both the tool itself as well as any tool behaviors defined in allowed_tools.
Arguments:</p>
<ul>
<li>user - User handling the tool.</li>
<li>tool - The tool (or item) being used in this surgery step.
Returns TRUE if the tool can be used, or FALSE otherwise</li>
</ul><h3 id="proc/slowdown_immune"><aside class="declaration">proc </aside>slowdown_immune<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/user) 
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L433">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 433"/></a></aside>
        </h3>
        <p>Check for mobs that would be immune to surgery slowdowns/speedups.</p><h3 id="proc/tool_check"><aside class="declaration">proc </aside>tool_check<aside>(/<a href="mob.html">mob</a>/user, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool) 
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L427">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 427"/></a></aside>
        </h3>
        <p>Get whether the tool should be usable in its current state. Useful for checks to see if a welder is on, for example.</p>
<p>Arguments:</p>
<ul>
<li>user - The user using the tool.</li>
<li>tool - The tool in use.</li>
</ul><h3 id="proc/try_op"><aside class="declaration">proc </aside>try_op<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/user, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/target, target_zone, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool, /<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/surgery) 
        
    
            <a href="https://github.com/trebla64/Paradise/blob/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f/code/modules/surgery/surgery.dm#L260">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;surgery&#x2F;surgery.dm 260"/></a></aside>
        </h3>
        <p>Try to perform an operation on a user.
Arguments:</p>
<ul>
<li>user - The user performing the surgery.</li>
<li>target - The user on whom the surgery is being performed.</li>
<li>target_zone - the zone the user is targeting for the surgery.</li>
<li>tool - The object that the user is using to perform the surgery (optional)</li>
<li>surgery - The surgery being performed.
Returns TRUE if the step was a success, or FALSE if the step can't be performed for some reason.</li>
</ul></main>
<footer>
    paradise.dme
    <a href="https://github.com/trebla64/Paradise/tree/5c9d20f65f52b3a1c3eb9c2e558a62def94d688f">5c9d20f</a>
        (master) &mdash; <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/src/dmdoc/README.md">dmdoc 1.4.1</a></footer>
</body>
</html>
